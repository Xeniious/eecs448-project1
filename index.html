<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="stylesheet.css">
  <link rel="stylesheet" href="btn_toggle/btn_toggle.css">
  <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.css">
  <title>team "Team" - Calendar View</title>
</head>
<body>
  <div id="navbar" class="options_toolbar">
    <div onclick="javascript:toggle_navbar();" style="display:block;width:100%;padding-left:50px;font-size:28px;">
      &times; Close Options</div>
    <div>Toggle 24hr Time
      <div style="float:right;" dragabble="false" class="btn_wrapper" id="BTN1" onclick="javascript:btn_toggle(0, 'BTN1', 'BTN1_in');toggleTime();">
        <div dragabble="false" class="btn_inner" id="BTN1_in"><div dragabble="false">O</div></div>
      </div>
    </div>
  </div>

  <div class="wrapper">
    <span class="options_toolbar">
      <div class="fa fa-2x fa-gear settings" onclick="javascript:toggle_navbar();"></div>
    </span>

    <span class="date_header">

      <div class="dayname" id="dayOfWeek">Sunday,</div>
      <div class="date_text" id="monthAndDay">August 9th</div>

      <center>
      <div id="eventCreation" style="display:none;position:absolute;top:200px;right:0.5em;">
      <input style="border-radius:5px;" type="text" id="host" placeholder="Enter your name"></input>
      <input type="text" id="name" placeholder="Enter event name"></input>

      <button onclick="javascript:constructEvent();">Create Event</button>
      </div>
      </center>

      <button style="position:absolute;top:200px;right:0.5em;" id="eventCreationButton" onclick="javascript:showEventCreation();">Create an event on this day</button>

    </span>

    <div class="date_view">
    </div> <!--date_view-->
</div> <!--wrapper-->

<script>
var time_selections = [];
// Navbar Functionality
var toggle = true;
function toggle_navbar() {
  if(toggle) {
    document.getElementById('navbar').style.left = "0px";
    toggle = false;
  }else {
    document.getElementById('navbar').style.left = "-300px";
    toggle = true;
  }
  return;
}
// Initialize timeslots and display previously made event
window.onload = function() {
  updateTime();
  time_selections = [];
  var table_hours = ['12', '12', '1', '1', '2', '2', '3', '3', '4', '4', '5', '5', '6', '6', '7', '7', '8', '8', '9', '9', '10', '10', '11', '11'];
  var date_view = document.getElementsByClassName('date_view')[0];
  var t_block;
  var time;
  var text_hour;
  var text_halfhour;
  var am = true;
  var number_of_halfhours = 48; // 24 * 2
  for(var i = 0; i < number_of_halfhours; i++) {
    if(i % 2 === 1) {
      text_halfhour = '30';
    }else {
      text_halfhour = '00';
    }
    if(i < 24) {
      text_hour = table_hours[i];
      date_view.innerHTML += '<div class="t_block"></div>';
      t_block = {
        element: document.getElementsByClassName('t_block')[i],
        selected: false,
        events: getEvents(),
        time: text_hour + ':' + text_halfhour + ' am'
      };
      time_selections.push(t_block);
      t_block.element.innerHTML += '<div onclick="javascript:toggle_timeAdd('+ i +');" class="time"></div>';
        // Check for event and display event
      time = document.getElementsByClassName('time')[i];
      time.innerHTML += t_block.time;
    } else {
      text_hour = table_hours[i - 24];
      date_view.innerHTML += '<div class="t_block"></div>';
      t_block = {
        element: document.getElementsByClassName('t_block')[i],
        selected: false,
        events: getEvents(),
        time: text_hour + ':' + text_halfhour + ' pm'
      };
      time_selections.push(t_block);
      t_block.element.innerHTML += '<div onclick="javascript:toggle_timeAdd('+ i +');" class="time"></div>';
        // Check for event and display event
      time = document.getElementsByClassName('time')[i];
      time.innerHTML += t_block.time;
    }
  }
};
// Toggles the selected behavior of each timeslot
function toggle_timeAdd(index) {
  if(!time_selections[index].selected) {
    document.getElementsByClassName('t_block')[index].style.backgroundColor = "green";
    document.getElementsByClassName('time')[index].style.color = "#ffffff";
    time_selections[index].selected = true;
  }else {
    document.getElementsByClassName('t_block')[index].style.backgroundColor = "#ffffff";
    document.getElementsByClassName('time')[index].style.color = "#333";
    time_selections[index].selected = false;
  }
}
// Accessed in constructEvent.js
function getSelectedTimes() {
  var timeslots = [];
  for(var i = 0; i < time_selections.length; i++) {
    if(time_selections[i].selected) {
      timeslots.push(time_selections[i].time);
    }
  }
  return timeslots;
}

function resetSelectedTimes() {
  for(var i = 0; i < time_selections.length; i++) {
    if(time_selections[i].selected) {
      toggle_timeAdd(i);
    }
  }
}
</script>

<script src="test/saveEventsArray.js" type="text/javascript"></script>
<script src="test/event.js" type="text/javascript"></script>
<script src="test/constructEvent.js" type="text/javascript"></script>
<script src="btn_toggle/toggleTime.js" type="text/javascript"></script>
<script src="btn_toggle/btn_toggle.js" type="text/javascript"></script>
<script src="Date/date.js" type="text/javascript"></script>

</body>
</html>
